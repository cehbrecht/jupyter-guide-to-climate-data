
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Use CMIP6 models together with observational data &#8212; Jupyter Guide to Climate Data</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Prepare modeling data for GIS analyses" href="gis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Jupyter Guide to Climate Data</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Jupyter Guide to Climate Data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdo.html">
   CDO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="xarray.html">
   Data Chunking with Dask
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdo-cmor.html">
   cdo cmor: basic standardizing examples (“CMORizing”)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Regrid_xESMF.html">
   Regridding with xESMF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="esgf-subset-cmip6.html">
   ESGF: Subset CMIP6 Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdo-subset-cmip6.html">
   cdo: run subset operations (command line)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CDS.html">
   Copernicus Climate Data Store
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CDS-demo.html">
   CDS: Live Demo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cdsapi.html">
   CDS Demo: Using Climate Data Store API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rooki.html">
   CDS Demo: Use Rooki to access CMIP6 data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PROV.html">
   Provenance Demo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CLINT.html">
   CLINT - Climate Intelligence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CLINT-demo.html">
   CLINT - Demo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gis.html">
   Prepare modeling data for GIS analyses
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Use CMIP6 models together with observational data
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/cehbrecht/jupyter-guide-to-climate-data/main?urlpath=tree/validation-with-obs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/validation-with-obs.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Use CMIP6 models together with observational data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-model">
   1. Load the model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-observational-data">
     2. Load the observational data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#in-sections-2-0-2-1-we-describe-how-to-retrive-the-observational-dataset-from-cds-for-the-purpose-of-this-workshop-however-we-have-already-prepared-this-dataset-so-you-can-directly-load-it-in-section-2-2">
       In sections 2.0 - 2.1 we describe how to retrive the observational dataset from CDS. For the purpose of this workshop, however, we have already prepared this dataset, so you can directly load it in section 2.2.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cds-api">
       2.0 CDS API
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#downlod-the-data-from-the-cds">
       2.1 Downlod the data from the CDS
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regridding">
     3. Regridding
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validate-the-model">
     4. Validate the model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Use CMIP6 models together with observational data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Use CMIP6 models together with observational data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-model">
   1. Load the model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-observational-data">
     2. Load the observational data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#in-sections-2-0-2-1-we-describe-how-to-retrive-the-observational-dataset-from-cds-for-the-purpose-of-this-workshop-however-we-have-already-prepared-this-dataset-so-you-can-directly-load-it-in-section-2-2">
       In sections 2.0 - 2.1 we describe how to retrive the observational dataset from CDS. For the purpose of this workshop, however, we have already prepared this dataset, so you can directly load it in section 2.2.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cds-api">
       2.0 CDS API
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#downlod-the-data-from-the-cds">
       2.1 Downlod the data from the CDS
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regridding">
     3. Regridding
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validate-the-model">
     4. Validate the model
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="use-cmip6-models-together-with-observational-data">
<h1>Use CMIP6 models together with observational data<a class="headerlink" href="#use-cmip6-models-together-with-observational-data" title="Permalink to this headline">#</a></h1>
<p>This example demonstrates how to combine CMIP6 models with observational data from the Copernicus Climate Data Store (CDS). We have chosen Surface Downwelling Longwave Radiation (rlds variable) here. We will load the data, regrid the observational dataset and use it to validate the model. First, load all nesessary libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">intake</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>
<span class="kn">import</span> <span class="nn">cf_xarray</span> <span class="k">as</span> <span class="nn">cfxr</span>
<span class="kn">import</span> <span class="nn">ESMF</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using xESMF in version </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">xe</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using xESMF in version 0.6.3
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-the-model">
<h1>1. Load the model<a class="headerlink" href="#load-the-model" title="Permalink to this headline">#</a></h1>
<p>We then load one of the historical monthly CMIP6 models for December 2014 from Mistral, look at its metadata, and plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="s2">&quot;/pool/data/Catalogs/dkrz_cmip6_disk.json&quot;</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">variable_id</span> <span class="o">=</span> <span class="s2">&quot;rlds&quot;</span><span class="p">,</span>
                 <span class="n">table_id</span> <span class="o">=</span> <span class="s2">&quot;Amon&quot;</span><span class="p">,</span>
                 <span class="n">activity_id</span> <span class="o">=</span> <span class="s2">&quot;CMIP&quot;</span><span class="p">,</span>
                 <span class="n">experiment_id</span> <span class="o">=</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
                <span class="n">source_id</span> <span class="o">=</span> <span class="s2">&quot;MPI-ESM1-2-HR&quot;</span><span class="p">,</span>
                <span class="n">member_id</span> <span class="o">=</span> <span class="s2">&quot;r1i1p1f1&quot;</span><span class="p">)</span>
<span class="n">xr_dict</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">()</span>
<span class="n">dset</span> <span class="o">=</span> <span class="n">xr_dict</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">xr_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">dset</span><span class="p">[</span><span class="s1">&#39;rlds&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/k/k204199/.conda/envs/summerschool_2022/lib/python3.10/site-packages/intake_esm/core.py:84: DtypeWarning: Columns (21,22,23) have mixed types.Specify dtype option on import or set low_memory=False.
  self._df, self.catalog_file = _fetch_catalog(self.esmcol_data, esmcol_obj, csv_kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;activity_id.source_id.experiment_id.table_id.grid_label&#39;
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [1/1 00:00&lt;00:00]
</div>
</div><div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;rlds&#x27; (member_id: 1, time: 1980, lat: 192, lon: 384)&gt;
dask.array&lt;broadcast_to, shape=(1, 1980, 192, 384), dtype=float32, chunksize=(1, 60, 192, 384), chunktype=numpy.ndarray&gt;
Coordinates:
  * time       (time) datetime64[ns] 1850-01-16T12:00:00 ... 2014-12-16T12:00:00
  * lat        (lat) float64 -89.28 -88.36 -87.42 -86.49 ... 87.42 88.36 89.28
  * lon        (lon) float64 0.0 0.9375 1.875 2.812 ... 356.2 357.2 358.1 359.1
  * member_id  (member_id) &lt;U8 &#x27;r1i1p1f1&#x27;
Attributes:
    standard_name:  surface_downwelling_longwave_flux_in_air
    long_name:      Surface Downwelling Longwave Radiation
    comment:        The surface called &#x27;surface&#x27; means the lower boundary of ...
    units:          W m-2
    original_name:  rlds
    cell_methods:   area: time: mean
    cell_measures:  area: areacella
    history:        2019-08-25T06:42:06Z altered by CMOR: replaced missing va...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'rlds'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>member_id</span>: 1</li><li><span class='xr-has-index'>time</span>: 1980</li><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 384</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a7c3bb75-a3f5-4cfa-85e7-43f2c380ef96' class='xr-array-in' type='checkbox' checked><label for='section-a7c3bb75-a3f5-4cfa-85e7-43f2c380ef96' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 60, 192, 384), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 556.88 MiB </td>
                        <td> 16.88 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (1, 1980, 192, 384) </td>
                        <td> (1, 60, 192, 384) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 68 Graph Layers </td>
                        <td> 33 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="352" height="159" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="95" y1="38" x2="165" y2="109" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="38" style="stroke-width:2" />
  <line x1="97" y1="2" x2="97" y2="40" />
  <line x1="99" y1="4" x2="99" y2="42" />
  <line x1="101" y1="6" x2="101" y2="44" />
  <line x1="103" y1="8" x2="103" y2="46" />
  <line x1="105" y1="10" x2="105" y2="49" />
  <line x1="107" y1="12" x2="107" y2="51" />
  <line x1="109" y1="14" x2="109" y2="53" />
  <line x1="112" y1="17" x2="112" y2="55" />
  <line x1="114" y1="19" x2="114" y2="57" />
  <line x1="116" y1="21" x2="116" y2="59" />
  <line x1="118" y1="23" x2="118" y2="61" />
  <line x1="120" y1="25" x2="120" y2="64" />
  <line x1="122" y1="27" x2="122" y2="66" />
  <line x1="124" y1="29" x2="124" y2="68" />
  <line x1="127" y1="32" x2="127" y2="70" />
  <line x1="129" y1="34" x2="129" y2="72" />
  <line x1="131" y1="36" x2="131" y2="74" />
  <line x1="133" y1="38" x2="133" y2="76" />
  <line x1="135" y1="40" x2="135" y2="79" />
  <line x1="137" y1="42" x2="137" y2="81" />
  <line x1="139" y1="44" x2="139" y2="83" />
  <line x1="142" y1="47" x2="142" y2="85" />
  <line x1="144" y1="49" x2="144" y2="87" />
  <line x1="146" y1="51" x2="146" y2="89" />
  <line x1="148" y1="53" x2="148" y2="91" />
  <line x1="150" y1="55" x2="150" y2="94" />
  <line x1="152" y1="57" x2="152" y2="96" />
  <line x1="154" y1="59" x2="154" y2="98" />
  <line x1="157" y1="62" x2="157" y2="100" />
  <line x1="159" y1="64" x2="159" y2="102" />
  <line x1="161" y1="66" x2="161" y2="104" />
  <line x1="165" y1="70" x2="165" y2="109" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 165.58823529411765,70.58823529411765 165.58823529411765,109.01386754281697 95.0,38.42563224869931" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="136" y2="0" style="stroke-width:2" />
  <line x1="97" y1="2" x2="139" y2="2" />
  <line x1="99" y1="4" x2="141" y2="4" />
  <line x1="101" y1="6" x2="143" y2="6" />
  <line x1="103" y1="8" x2="145" y2="8" />
  <line x1="105" y1="10" x2="147" y2="10" />
  <line x1="107" y1="12" x2="149" y2="12" />
  <line x1="109" y1="14" x2="151" y2="14" />
  <line x1="112" y1="17" x2="153" y2="17" />
  <line x1="114" y1="19" x2="156" y2="19" />
  <line x1="116" y1="21" x2="158" y2="21" />
  <line x1="118" y1="23" x2="160" y2="23" />
  <line x1="120" y1="25" x2="162" y2="25" />
  <line x1="122" y1="27" x2="164" y2="27" />
  <line x1="124" y1="29" x2="166" y2="29" />
  <line x1="127" y1="32" x2="168" y2="32" />
  <line x1="129" y1="34" x2="171" y2="34" />
  <line x1="131" y1="36" x2="173" y2="36" />
  <line x1="133" y1="38" x2="175" y2="38" />
  <line x1="135" y1="40" x2="177" y2="40" />
  <line x1="137" y1="42" x2="179" y2="42" />
  <line x1="139" y1="44" x2="181" y2="44" />
  <line x1="142" y1="47" x2="183" y2="47" />
  <line x1="144" y1="49" x2="186" y2="49" />
  <line x1="146" y1="51" x2="188" y2="51" />
  <line x1="148" y1="53" x2="190" y2="53" />
  <line x1="150" y1="55" x2="192" y2="55" />
  <line x1="152" y1="57" x2="194" y2="57" />
  <line x1="154" y1="59" x2="196" y2="59" />
  <line x1="157" y1="62" x2="198" y2="62" />
  <line x1="159" y1="64" x2="201" y2="64" />
  <line x1="161" y1="66" x2="203" y2="66" />
  <line x1="165" y1="70" x2="207" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="136" y1="0" x2="207" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 136.87882345035473,0.0 207.46705874447238,70.58823529411765 165.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="165" y1="70" x2="207" y2="70" style="stroke-width:2" />
  <line x1="165" y1="109" x2="207" y2="109" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="165" y1="70" x2="165" y2="109" style="stroke-width:2" />
  <line x1="207" y1="70" x2="207" y2="109" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="165.58823529411765,70.58823529411765 207.46705874447235,70.58823529411765 207.46705874447235,109.01386754281697 165.58823529411765,109.01386754281697" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="186.527647" y="129.013868" font-size="1.0rem" font-weight="100" text-anchor="middle" >384</text>
  <text x="227.467059" y="89.801051" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,227.467059,89.801051)">192</text>
  <text x="120.294118" y="93.719750" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,120.294118,93.719750)">1980</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-65fbab52-1263-4c43-bfbe-784087df8aad' class='xr-section-summary-in' type='checkbox'  checked><label for='section-65fbab52-1263-4c43-bfbe-784087df8aad' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-16T12:00:00 ... 2014-12-...</div><input id='attrs-bbeb755b-0b74-4bb9-9f5d-5553f604a208' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bbeb755b-0b74-4bb9-9f5d-5553f604a208' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a49c1ad-4d9f-43af-b950-57b937e5e3c2' class='xr-var-data-in' type='checkbox'><label for='data-2a49c1ad-4d9f-43af-b950-57b937e5e3c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-16T12:00:00.000000000&#x27;, &#x27;1850-02-15T00:00:00.000000000&#x27;,
       &#x27;1850-03-16T12:00:00.000000000&#x27;, ..., &#x27;2014-10-16T12:00:00.000000000&#x27;,
       &#x27;2014-11-16T00:00:00.000000000&#x27;, &#x27;2014-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.28 -88.36 ... 88.36 89.28</div><input id='attrs-139175b2-b573-4ca6-83b2-cca4e0a0ef61' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-139175b2-b573-4ca6-83b2-cca4e0a0ef61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09f44088-18e2-4ce5-b62d-3b700ac9db93' class='xr-var-data-in' type='checkbox'><label for='data-09f44088-18e2-4ce5-b62d-3b700ac9db93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.284228, -88.357004, -87.424304, -86.490367, -85.55596 , -84.621327,
       -83.686567, -82.751728, -81.816839, -80.881913, -79.946962, -79.011992,
       -78.077007, -77.142011, -76.207005, -75.271992, -74.336973, -73.401949,
       -72.466921, -71.531889, -70.596854, -69.661816, -68.726776, -67.791734,
       -66.856691, -65.921645, -64.986599, -64.051551, -63.116502, -62.181452,
       -61.246401, -60.311349, -59.376297, -58.441244, -57.50619 , -56.571136,
       -55.636081, -54.701026, -53.76597 , -52.830914, -51.895857, -50.960801,
       -50.025743, -49.090686, -48.155628, -47.22057 , -46.285512, -45.350454,
       -44.415395, -43.480336, -42.545277, -41.610218, -40.675159, -39.740099,
       -38.805039, -37.86998 , -36.93492 , -35.99986 , -35.064799, -34.129739,
       -33.194679, -32.259618, -31.324558, -30.389497, -29.454436, -28.519375,
       -27.584315, -26.649254, -25.714193, -24.779132, -23.84407 , -22.909009,
       -21.973948, -21.038887, -20.103825, -19.168764, -18.233703, -17.298641,
       -16.36358 , -15.428518, -14.493457, -13.558395, -12.623333, -11.688272,
       -10.75321 ,  -9.818148,  -8.883087,  -7.948025,  -7.012963,  -6.077901,
        -5.14284 ,  -4.207778,  -3.272716,  -2.337654,  -1.402593,  -0.467531,
         0.467531,   1.402593,   2.337654,   3.272716,   4.207778,   5.14284 ,
         6.077901,   7.012963,   7.948025,   8.883087,   9.818148,  10.75321 ,
        11.688272,  12.623333,  13.558395,  14.493457,  15.428518,  16.36358 ,
        17.298641,  18.233703,  19.168764,  20.103825,  21.038887,  21.973948,
        22.909009,  23.84407 ,  24.779132,  25.714193,  26.649254,  27.584315,
        28.519375,  29.454436,  30.389497,  31.324558,  32.259618,  33.194679,
        34.129739,  35.064799,  35.99986 ,  36.93492 ,  37.86998 ,  38.805039,
        39.740099,  40.675159,  41.610218,  42.545277,  43.480336,  44.415395,
        45.350454,  46.285512,  47.22057 ,  48.155628,  49.090686,  50.025743,
        50.960801,  51.895857,  52.830914,  53.76597 ,  54.701026,  55.636081,
        56.571136,  57.50619 ,  58.441244,  59.376297,  60.311349,  61.246401,
        62.181452,  63.116502,  64.051551,  64.986599,  65.921645,  66.856691,
        67.791734,  68.726776,  69.661816,  70.596854,  71.531889,  72.466921,
        73.401949,  74.336973,  75.271992,  76.207005,  77.142011,  78.077007,
        79.011992,  79.946962,  80.881913,  81.816839,  82.751728,  83.686567,
        84.621327,  85.55596 ,  86.490367,  87.424304,  88.357004,  89.284228])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9375 1.875 ... 358.1 359.1</div><input id='attrs-5065c0a8-af9f-4873-8619-f4cf60475bd6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5065c0a8-af9f-4873-8619-f4cf60475bd6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba507f25-ec6d-41a9-a2c4-f9b8070eba80' class='xr-var-data-in' type='checkbox'><label for='data-ba507f25-ec6d-41a9-a2c4-f9b8070eba80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([  0.    ,   0.9375,   1.875 , ..., 357.1875, 358.125 , 359.0625])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>member_id</span></div><div class='xr-var-dims'>(member_id)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;r1i1p1f1&#x27;</div><input id='attrs-0b81381e-c69d-4f3b-9d9d-01822c9ba0fb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0b81381e-c69d-4f3b-9d9d-01822c9ba0fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f725ad1d-fb46-48e4-bf27-899fc5bebb91' class='xr-var-data-in' type='checkbox'><label for='data-f725ad1d-fb46-48e4-bf27-899fc5bebb91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;r1i1p1f1&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9e22c53f-bbc8-496a-ad09-6545c50e5b11' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9e22c53f-bbc8-496a-ad09-6545c50e5b11' class='xr-section-summary' >Attributes: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_downwelling_longwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface Downwelling Longwave Radiation</dd><dt><span>comment :</span></dt><dd>The surface called &#x27;surface&#x27; means the lower boundary of the atmosphere. &#x27;longwave&#x27; means longwave radiation. Downwelling radiation is radiation from above. It does not mean &#x27;net downward&#x27;. When thought of as being incident on a surface, a radiative flux is sometimes called &#x27;irradiance&#x27;. In addition, it is identical with the quantity measured by a cosine-collector light-meter and sometimes called &#x27;vector irradiance&#x27;. In accordance with common usage in geophysical disciplines, &#x27;flux&#x27; implies per unit area, called &#x27;flux density&#x27; in physics.</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>original_name :</span></dt><dd>rlds</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>history :</span></dt><dd>2019-08-25T06:42:06Z altered by CMOR: replaced missing value flag (-9e+33) and corresponding data with standard missing value (1e+20). 2019-08-25T06:42:06Z altered by CMOR: Inverted axis: lat.</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">dset</span><span class="p">[</span><span class="s1">&#39;rlds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;2014-12-16T12:00:00&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span>
            <span class="n">dset</span><span class="p">[</span><span class="s1">&#39;rlds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;2014-12-16T12:00:00&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
            <span class="n">dset</span><span class="p">[</span><span class="s1">&#39;rlds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;2014-12-16T12:00:00&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">60</span><span class="p">,</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>

<span class="c1"># Add a color bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Surface Downwelling Longwave Radiation in Dec 2014 (CMIP6), W m-2&#39;</span><span class="p">,</span> 
          <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;fontweight&#39;</span> <span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/validation-with-obs_4_0.png" src="_images/validation-with-obs_4_0.png" />
</div>
</div>
<section id="load-the-observational-data">
<h2>2. Load the observational data<a class="headerlink" href="#load-the-observational-data" title="Permalink to this headline">#</a></h2>
<p>As an observational dataset we chose the Surface Downwelling Longwave Radiation derived from AHVRR satellite. We download it from the Climate Data Store.
<a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/dataset/satellite-surface-radiation-budget?tab=form">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-surface-radiation-budget?tab=form</a></p>
<section id="in-sections-2-0-2-1-we-describe-how-to-retrive-the-observational-dataset-from-cds-for-the-purpose-of-this-workshop-however-we-have-already-prepared-this-dataset-so-you-can-directly-load-it-in-section-2-2">
<h3>In sections 2.0 - 2.1 we describe how to retrive the observational dataset from CDS. For the purpose of this workshop, however, we have already prepared this dataset, so you can directly load it in section 2.2.<a class="headerlink" href="#in-sections-2-0-2-1-we-describe-how-to-retrive-the-observational-dataset-from-cds-for-the-purpose-of-this-workshop-however-we-have-already-prepared-this-dataset-so-you-can-directly-load-it-in-section-2-2" title="Permalink to this headline">#</a></h3>
</section>
<section id="cds-api">
<h3>2.0 CDS API<a class="headerlink" href="#cds-api" title="Permalink to this headline">#</a></h3>
<p>In order to do so we used CDS API which we need to set up first. Please refer to the source git repository for the details on the installation and use of this package.
<a class="reference external" href="https://github.com/ecmwf/cdsapi">https://github.com/ecmwf/cdsapi</a></p>
<p>You would need to enter your UID and your API Key to use CDS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install cdsapi</span>
<span class="c1"># cat &gt; ~/.cdsapirc</span>
<span class="c1"># url: https://cds.climate.copernicus.eu/api/v2</span>
<span class="c1"># key: &lt;your UID&gt;:&lt;your API Key&gt;</span>
<span class="c1"># verify: 0</span>
<span class="c1">#pip install cfgrib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="kn">import</span> <span class="nn">cfgrib</span>
<span class="n">cds</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="downlod-the-data-from-the-cds">
<h3>2.1 Downlod the data from the CDS<a class="headerlink" href="#downlod-the-data-from-the-cds" title="Permalink to this headline">#</a></h3>
<p>We download the dataset for the same month as our modeling daset, unzip it, load it to the notebook, check its metadata, and finally plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cds</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
     <span class="s1">&#39;satellite-surface-radiation-budget&#39;</span><span class="p">,</span>
     <span class="p">{</span>
         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;tgz&#39;</span><span class="p">,</span>
         <span class="s1">&#39;product_family&#39;</span><span class="p">:</span> <span class="s1">&#39;clara&#39;</span><span class="p">,</span>
         <span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="s1">&#39;eumetsat&#39;</span><span class="p">,</span>
         <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_downwelling_longwave_flux&#39;</span><span class="p">,</span>
         <span class="s1">&#39;time_aggregation&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_mean&#39;</span><span class="p">,</span>
         <span class="s1">&#39;climate_data_record_type&#39;</span><span class="p">:</span> <span class="s1">&#39;thematic_climate_data_record&#39;</span><span class="p">,</span>
         <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span>
         <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;12&#39;</span><span class="p">,</span>
         <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;v2_0&#39;</span><span class="p">,</span>
         <span class="s1">&#39;sensor_on_satellite&#39;</span><span class="p">:</span> <span class="s1">&#39;avhrr_on_multiple_satellites&#39;</span><span class="p">,</span>
     <span class="p">},</span>
     <span class="s1">&#39;download.tar.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/k/k204199/.conda/envs/summerschool_2022/lib/python3.10/site-packages/urllib3/connectionpool.py:1045: InsecureRequestWarning: Unverified HTTPS request is being made to host &#39;cds.climate.copernicus.eu&#39;. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
2022-08-31 10:01:17,371 INFO Welcome to the CDS
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-08-31 10:01:17,372 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/satellite-surface-radiation-budget
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/k/k204199/.conda/envs/summerschool_2022/lib/python3.10/site-packages/urllib3/connectionpool.py:1045: InsecureRequestWarning: Unverified HTTPS request is being made to host &#39;cds.climate.copernicus.eu&#39;. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
2022-08-31 10:01:17,478 INFO Request is completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-08-31 10:01:17,479 INFO Downloading https://download-0019.copernicus-climate.eu/cache-compute-0019/cache/data4/dataset-satellite-surface-radiation-budget-d6bfdb4c-680a-48f2-bccb-52052acfe6a5.tar.gz to download.tar.gz (6.3M)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/k/k204199/.conda/envs/summerschool_2022/lib/python3.10/site-packages/urllib3/connectionpool.py:1045: InsecureRequestWarning: Unverified HTTPS request is being made to host &#39;download-0019.copernicus-climate.eu&#39;. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                                                                                             | 0.00/6.28M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|███▉                                                                                                                                 | 191k/6.28M [00:00&lt;00:03, 1.77MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|███████████████████████████████▏                                                                                                    | 1.48M/6.28M [00:00&lt;00:00, 7.80MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 5.30M/6.28M [00:00&lt;00:00, 20.6MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                                                                              
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-08-31 10:01:18,048 INFO Download rate 11M/s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=6580570,content_type=application/gzip,location=https://download-0019.copernicus-climate.eu/cache-compute-0019/cache/data4/dataset-satellite-surface-radiation-budget-d6bfdb4c-680a-48f2-bccb-52052acfe6a5.tar.gz)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tar -xvf download.tar.gz SDLmm20141201000000219AVPOS01GL.nc -C /obs/
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SDLmm20141201000000219AVPOS01GL.nc
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;SDLmm20141201000000219AVPOS01GL.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">obs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (lon: 1440, lat: 720, nv: 2)
Coordinates:
  * lon        (lon) float64 -179.9 -179.6 -179.4 -179.1 ... 179.4 179.6 179.9
  * lat        (lat) float64 -89.88 -89.62 -89.38 -89.12 ... 89.38 89.62 89.88
    time       datetime64[ns] 2014-12-01
Dimensions without coordinates: nv
Data variables:
    time_bnds  (nv) datetime64[ns] 2014-12-01 2014-12-31T23:59:59
    SDL        (lat, lon) float32 ...
    SDL_nobs   (lat, lon) float64 ...
    SDL_stdv   (lat, lon) float32 ...
Attributes: (12/44)
    title:                           CM SAF Cloud, Albedo and Radiation datas...
    summary:                         This file contains AVHRR-based Thematic ...
    id:                              DOI:10.5676/EUM_SAF_CM/CLARA_AVHRR/V002
    product_class:                   Radiation products, monthly means
    Conventions:                     CF-1.6,ACDD-1.3
    standard_name_vocabulary:        Standard Name Table (v28, 07 January 2015)
    ...                              ...
    cmsaf_parameter_code:            SDL_AVHRR_global_DS
    L3_processor:                    CMSAFGACL3_V2.0, Sirah Software, V1.0
    L2_processors:                   PPS2014 incl. patch 1 and CPP;
    Level1_intercalibration:         1.0
    date_created:                    2016-10-10T08:16:53 UTC
    reference_documents:             Algorithm Theoretical Baseline Document ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-62693920-f560-4107-8276-5ded53ffd28a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-62693920-f560-4107-8276-5ded53ffd28a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>lat</span>: 720</li><li><span>nv</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ed2886b6-3fd4-4586-ad89-3b2b1a6d4390' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ed2886b6-3fd4-4586-ad89-3b2b1a6d4390' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-179.9 -179.6 ... 179.6 179.9</div><input id='attrs-0c4dfbd0-c011-418a-a3c2-037c28cc905c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c4dfbd0-c011-418a-a3c2-037c28cc905c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93157706-6ee3-4ea6-834c-8879d048e130' class='xr-var-data-in' type='checkbox'><label for='data-93157706-6ee3-4ea6-834c-8879d048e130' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-179.875, -179.625, -179.375, ...,  179.375,  179.625,  179.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.88 -89.62 ... 89.62 89.88</div><input id='attrs-c3b08755-ea15-43c7-89cf-03cd887efaf5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c3b08755-ea15-43c7-89cf-03cd887efaf5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5122870c-016f-46cd-a899-6fc34ee22794' class='xr-var-data-in' type='checkbox'><label for='data-5122870c-016f-46cd-a899-6fc34ee22794' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-89.875, -89.625, -89.375, ...,  89.375,  89.625,  89.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2014-12-01</div><input id='attrs-4ba37300-b5bb-4598-97c6-f532b7173cdd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ba37300-b5bb-4598-97c6-f532b7173cdd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff759f49-4dd0-46ae-b04e-928ddd19831a' class='xr-var-data-in' type='checkbox'><label for='data-ff759f49-4dd0-46ae-b04e-928ddd19831a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2014-12-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-47a63401-b1d7-4106-b588-2199880f148f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47a63401-b1d7-4106-b588-2199880f148f' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(nv)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0ec2f6c1-0309-465b-a700-328669e9cbb1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0ec2f6c1-0309-465b-a700-328669e9cbb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bd7ce2d-345e-4525-b36f-1c12ce3a0513' class='xr-var-data-in' type='checkbox'><label for='data-2bd7ce2d-345e-4525-b36f-1c12ce3a0513' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time Bounds</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2014-12-01T00:00:00.000000000&#x27;, &#x27;2014-12-31T23:59:59.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SDL</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-179896f8-84f2-46f8-9da2-f46cb8631e86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-179896f8-84f2-46f8-9da2-f46cb8631e86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e8b9d4f-086a-482e-9be8-cd84a752bfd9' class='xr-var-data-in' type='checkbox'><label for='data-2e8b9d4f-086a-482e-9be8-cd84a752bfd9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_downwelling_longwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>long_name :</span></dt><dd>Surface Downwelling Longwave Radiation</dd></dl></div><div class='xr-var-data'><pre>[1036800 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SDL_nobs</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e1cb29e1-7411-4d0e-936f-808d89f7f742' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e1cb29e1-7411-4d0e-936f-808d89f7f742' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43645748-4885-494f-9d0e-1643d59b25a4' class='xr-var-data-in' type='checkbox'><label for='data-43645748-4885-494f-9d0e-1643d59b25a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_downwelling_longwave_flux number_of_observations</dd><dt><span>long_name :</span></dt><dd>Number of Observations of the surface_downwelling_longwave_flux</dd><dt><span>missing_data :</span></dt><dd>-99</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>cell_methods :</span></dt><dd>area: time: sum</dd></dl></div><div class='xr-var-data'><pre>[1036800 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SDL_stdv</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-466ca334-ecfb-4a5d-b87b-ea18bbd2a935' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-466ca334-ecfb-4a5d-b87b-ea18bbd2a935' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18e9c0f8-9e4b-40bf-bd00-50b7cff84a73' class='xr-var-data-in' type='checkbox'><label for='data-18e9c0f8-9e4b-40bf-bd00-50b7cff84a73' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standard Deviation of the surface_downwelling_longwave_flux</dd><dt><span>missing_data :</span></dt><dd>-999.0</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>area: time: standard_deviation</dd></dl></div><div class='xr-var-data'><pre>[1036800 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-825361c9-6027-4682-933f-7c6a6b593425' class='xr-section-summary-in' type='checkbox'  ><label for='section-825361c9-6027-4682-933f-7c6a6b593425' class='xr-section-summary' >Attributes: <span>(44)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>CM SAF Cloud, Albedo and Radiation dataset, AVHRR-based edition 2 (CLARA-A2)</dd><dt><span>summary :</span></dt><dd>This file contains AVHRR-based Thematic Climate Data Records (TCDR) 
 produced by the Satellite Application Facility on Climate Monitoring (CM SAF).</dd><dt><span>id :</span></dt><dd>DOI:10.5676/EUM_SAF_CM/CLARA_AVHRR/V002</dd><dt><span>product_class :</span></dt><dd>Radiation products, monthly means</dd><dt><span>Conventions :</span></dt><dd>CF-1.6,ACDD-1.3</dd><dt><span>standard_name_vocabulary :</span></dt><dd>Standard Name Table (v28, 07 January 2015)</dd><dt><span>Metadata_Conventions :</span></dt><dd>Unidata Dataset Discovery v1.0</dd><dt><span>institution :</span></dt><dd>EUMETSAT/CMSAF</dd><dt><span>project :</span></dt><dd>Satellite Application Facility on Climate Monitoring (CM SAF)</dd><dt><span>digital_object_identifier :</span></dt><dd>10.5676/EUM_SAF_CM/CLARA_AVHRR/V002</dd><dt><span>creator_name :</span></dt><dd>DE/DWD</dd><dt><span>creator_url :</span></dt><dd>http://www.cmsaf.eu/</dd><dt><span>creator_email :</span></dt><dd>contact.cmsaf@dwd.de</dd><dt><span>references :</span></dt><dd>http://dx.doi.org/10.5676/EUM_SAF_CM/CLARA_AVHRR/V002</dd><dt><span>source :</span></dt><dd>AVHRR global area coverage (GAC)</dd><dt><span>cdm_data_type :</span></dt><dd>grid</dd><dt><span>filename :</span></dt><dd>SDLmm20141201000000219AVPOS01GL.nc</dd><dt><span>time_coverage_start :</span></dt><dd>2014-12-01T00:00:00</dd><dt><span>time_coverage_end :</span></dt><dd>2014-12-31T23:59:59</dd><dt><span>time_coverage_duration :</span></dt><dd>P1M</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1M</dd><dt><span>geospatial_lat_units :</span></dt><dd>degree_north</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>0.25 degree</dd><dt><span>geospatial_lat_min :</span></dt><dd>-90.0</dd><dt><span>geospatial_lat_max :</span></dt><dd>90.0</dd><dt><span>geospatial_lon_units :</span></dt><dd>degree_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.25 degree</dd><dt><span>geospatial_lon_min :</span></dt><dd>-180.0</dd><dt><span>geospatial_lon_max :</span></dt><dd>180.0</dd><dt><span>product_version :</span></dt><dd>2.0</dd><dt><span>cmsaf_gac_major_version_number :</span></dt><dd>1</dd><dt><span>cmsaf_gac_minor_version_number :</span></dt><dd>0</dd><dt><span>cmsaf_gac_parameter_name :</span></dt><dd>SDL</dd><dt><span>cmsaf_gac_parameter_id :</span></dt><dd>11261</dd><dt><span>platform_vocabulary :</span></dt><dd>GCMD Platforms, Version 8.1</dd><dt><span>platform :</span></dt><dd>NOAA POES &gt; NOAA Polar Orbiting Environmental Satellites</dd><dt><span>instrument :</span></dt><dd>AVHRR &gt; Advanced Very High Resolution Radiometer</dd><dt><span>cmsaf_parameter_id :</span></dt><dd>CM-11261</dd><dt><span>cmsaf_parameter_code :</span></dt><dd>SDL_AVHRR_global_DS</dd><dt><span>L3_processor :</span></dt><dd>CMSAFGACL3_V2.0, Sirah Software, V1.0</dd><dt><span>L2_processors :</span></dt><dd>PPS2014 incl. patch 1 and CPP;</dd><dt><span>Level1_intercalibration :</span></dt><dd>1.0</dd><dt><span>date_created :</span></dt><dd>2016-10-10T08:16:53 UTC</dd><dt><span>reference_documents :</span></dt><dd>Algorithm Theoretical Baseline Document (ATBD): SAF/CM/DWD/ATBD/GAC/RAD 
Product User Manual (PUM): SAF/CM/DWD/PUM/GAC/RAD 
Validation Report (VAL): SAF/CM/DWD/VAL/GAC/RAD;
 available at http://www.cmsaf.eu/</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;SDL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;SDL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;SDL&#39;</span><span class="p">],</span> <span class="mi">60</span><span class="p">,</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>

<span class="c1"># Add a color bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Surface Downwelling Longwave Radiation in Dec 2014 (AVHRR), W m-2&#39;</span><span class="p">,</span> 
          <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;fontweight&#39;</span> <span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/validation-with-obs_12_0.png" src="_images/validation-with-obs_12_0.png" />
</div>
</div>
</section>
</section>
<section id="regridding">
<h2>3. Regridding<a class="headerlink" href="#regridding" title="Permalink to this headline">#</a></h2>
<p>As we could find out from the metadata of both datasets, their dimesions are different. We therefore need to regrid one of the datasets before we could spatially overlay them. We will use xESMF and ESMF libraries for this purpose. Please refer to the respective documentation to see the details and parameters of the functions from these packages (<a class="reference external" href="https://xesmf.readthedocs.io/en/latest/index.html">https://xesmf.readthedocs.io/en/latest/index.html</a>, <a class="reference external" href="https://github.com/esmf-org/esmf">https://github.com/esmf-org/esmf</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In case of problems, activate ESMF verbose mode</span>
<span class="n">ESMF</span><span class="o">.</span><span class="n">Manager</span><span class="p">(</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Regridding methods</span>
<span class="n">method_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span><span class="s1">&#39;nearest_s2d&#39;</span><span class="p">,</span> <span class="s1">&#39;conservative&#39;</span><span class="p">,</span> <span class="s1">&#39;conservative_normed&#39;</span><span class="p">,</span> <span class="s1">&#39;patch&#39;</span><span class="p">]</span>

<span class="c1"># Function to generate the weights</span>
<span class="c1"># If grids have problems of degenerated cells near the poles there is the ignore_degenerate option</span>
<span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="n">ds_in</span><span class="p">,</span> <span class="n">ds_out</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">periodic</span><span class="p">,</span> <span class="n">unmapped_to_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ignore_degenerate</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience function for calculating regridding weights&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">ds_in</span><span class="p">,</span> <span class="n">ds_out</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">periodic</span> <span class="o">=</span> <span class="n">periodic</span><span class="p">,</span> 
                        <span class="n">unmapped_to_nan</span> <span class="o">=</span> <span class="n">unmapped_to_nan</span><span class="p">,</span> 
                        <span class="n">ignore_degenerate</span> <span class="o">=</span> <span class="n">ignore_degenerate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create a regridder for converting the observational dataset to match the model grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regridder</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">dset</span><span class="p">,</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span> <span class="n">periodic</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">unmapped_to_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ignore_degenerate</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> 
<span class="n">regridder</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xESMF Regridder 
Regridding algorithm:       bilinear 
Weight filename:            bilinear_720x1440_192x384_peri.nc 
Reuse pre-computed weights? False 
Input grid shape:           (720, 1440) 
Output grid shape:          (192, 384) 
Periodic in longitude?      True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Regrid the observational dataset and write write it to the xarray with the modeling dataset.</span>
<span class="n">dset</span><span class="p">[</span><span class="s2">&quot;AVHRR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regridder</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">SDL</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">na_thres</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">dset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (time: 1980, bnds: 2, lat: 192, lon: 384, member_id: 1)
Coordinates:
  * time       (time) datetime64[ns] 1850-01-16T12:00:00 ... 2014-12-16T12:00:00
  * lat        (lat) float64 -89.28 -88.36 -87.42 -86.49 ... 87.42 88.36 89.28
  * lon        (lon) float64 0.0 0.9375 1.875 2.812 ... 356.2 357.2 358.1 359.1
  * member_id  (member_id) &lt;U8 &#x27;r1i1p1f1&#x27;
Dimensions without coordinates: bnds
Data variables:
    time_bnds  (time, bnds) datetime64[ns] dask.array&lt;chunksize=(60, 2), meta=np.ndarray&gt;
    lat_bnds   (lat, bnds) float64 dask.array&lt;chunksize=(192, 2), meta=np.ndarray&gt;
    lon_bnds   (lon, bnds) float64 dask.array&lt;chunksize=(384, 2), meta=np.ndarray&gt;
    rlds       (member_id, time, lat, lon) float32 dask.array&lt;chunksize=(1, 60, 192, 384), meta=np.ndarray&gt;
    AVHRR      (lat, lon) float64 132.0 132.0 132.1 132.1 ... 196.4 196.5 196.5
Attributes: (12/49)
    parent_time_units:       days since 1850-1-1 00:00:00
    parent_variant_label:    r1i1p1f1
    title:                   MPI-ESM1-2-HR output prepared for CMIP6
    nominal_resolution:      100 km
    branch_time_in_parent:   0.0
    cmor_version:            3.5.0
    ...                      ...
    initialization_index:    1
    product:                 model-output
    license:                 CMIP6 model data produced by MPI-M is licensed u...
    further_info_url:        https://furtherinfo.es-doc.org/CMIP6.MPI-M.MPI-E...
    institution_id:          MPI-M
    intake_esm_dataset_key:  CMIP.MPI-ESM1-2-HR.historical.Amon.gn</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b77533b1-9fa6-43c0-8088-e7eab6e7068a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b77533b1-9fa6-43c0-8088-e7eab6e7068a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1980</li><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 384</li><li><span class='xr-has-index'>member_id</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9afb1041-e19d-48b9-84b1-d6b7ff48c7b1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9afb1041-e19d-48b9-84b1-d6b7ff48c7b1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-16T12:00:00 ... 2014-12-...</div><input id='attrs-18fa536e-7a1b-4fba-ab37-a72e32ed2d52' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18fa536e-7a1b-4fba-ab37-a72e32ed2d52' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cd7cd69-ee1c-4501-aabc-cffe2f707f73' class='xr-var-data-in' type='checkbox'><label for='data-7cd7cd69-ee1c-4501-aabc-cffe2f707f73' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-16T12:00:00.000000000&#x27;, &#x27;1850-02-15T00:00:00.000000000&#x27;,
       &#x27;1850-03-16T12:00:00.000000000&#x27;, ..., &#x27;2014-10-16T12:00:00.000000000&#x27;,
       &#x27;2014-11-16T00:00:00.000000000&#x27;, &#x27;2014-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.28 -88.36 ... 88.36 89.28</div><input id='attrs-d6b1eec0-f254-4f52-b273-51fe5785165b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d6b1eec0-f254-4f52-b273-51fe5785165b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-19237e35-e8a3-4ac2-b294-757f56827c18' class='xr-var-data-in' type='checkbox'><label for='data-19237e35-e8a3-4ac2-b294-757f56827c18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.284228, -88.357004, -87.424304, -86.490367, -85.55596 , -84.621327,
       -83.686567, -82.751728, -81.816839, -80.881913, -79.946962, -79.011992,
       -78.077007, -77.142011, -76.207005, -75.271992, -74.336973, -73.401949,
       -72.466921, -71.531889, -70.596854, -69.661816, -68.726776, -67.791734,
       -66.856691, -65.921645, -64.986599, -64.051551, -63.116502, -62.181452,
       -61.246401, -60.311349, -59.376297, -58.441244, -57.50619 , -56.571136,
       -55.636081, -54.701026, -53.76597 , -52.830914, -51.895857, -50.960801,
       -50.025743, -49.090686, -48.155628, -47.22057 , -46.285512, -45.350454,
       -44.415395, -43.480336, -42.545277, -41.610218, -40.675159, -39.740099,
       -38.805039, -37.86998 , -36.93492 , -35.99986 , -35.064799, -34.129739,
       -33.194679, -32.259618, -31.324558, -30.389497, -29.454436, -28.519375,
       -27.584315, -26.649254, -25.714193, -24.779132, -23.84407 , -22.909009,
       -21.973948, -21.038887, -20.103825, -19.168764, -18.233703, -17.298641,
       -16.36358 , -15.428518, -14.493457, -13.558395, -12.623333, -11.688272,
       -10.75321 ,  -9.818148,  -8.883087,  -7.948025,  -7.012963,  -6.077901,
        -5.14284 ,  -4.207778,  -3.272716,  -2.337654,  -1.402593,  -0.467531,
         0.467531,   1.402593,   2.337654,   3.272716,   4.207778,   5.14284 ,
         6.077901,   7.012963,   7.948025,   8.883087,   9.818148,  10.75321 ,
        11.688272,  12.623333,  13.558395,  14.493457,  15.428518,  16.36358 ,
        17.298641,  18.233703,  19.168764,  20.103825,  21.038887,  21.973948,
        22.909009,  23.84407 ,  24.779132,  25.714193,  26.649254,  27.584315,
        28.519375,  29.454436,  30.389497,  31.324558,  32.259618,  33.194679,
        34.129739,  35.064799,  35.99986 ,  36.93492 ,  37.86998 ,  38.805039,
        39.740099,  40.675159,  41.610218,  42.545277,  43.480336,  44.415395,
        45.350454,  46.285512,  47.22057 ,  48.155628,  49.090686,  50.025743,
        50.960801,  51.895857,  52.830914,  53.76597 ,  54.701026,  55.636081,
        56.571136,  57.50619 ,  58.441244,  59.376297,  60.311349,  61.246401,
        62.181452,  63.116502,  64.051551,  64.986599,  65.921645,  66.856691,
        67.791734,  68.726776,  69.661816,  70.596854,  71.531889,  72.466921,
        73.401949,  74.336973,  75.271992,  76.207005,  77.142011,  78.077007,
        79.011992,  79.946962,  80.881913,  81.816839,  82.751728,  83.686567,
        84.621327,  85.55596 ,  86.490367,  87.424304,  88.357004,  89.284228])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9375 1.875 ... 358.1 359.1</div><input id='attrs-959df772-30be-4648-889d-cb9235e56c5a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-959df772-30be-4648-889d-cb9235e56c5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ccb9e851-9250-49e1-b52f-8a6f908d745d' class='xr-var-data-in' type='checkbox'><label for='data-ccb9e851-9250-49e1-b52f-8a6f908d745d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([  0.    ,   0.9375,   1.875 , ..., 357.1875, 358.125 , 359.0625])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>member_id</span></div><div class='xr-var-dims'>(member_id)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;r1i1p1f1&#x27;</div><input id='attrs-ff5a5627-95ce-47b7-b3bd-9734942734b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff5a5627-95ce-47b7-b3bd-9734942734b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e5d1781-f44d-43bf-a4b3-0b04c79c0c37' class='xr-var-data-in' type='checkbox'><label for='data-6e5d1781-f44d-43bf-a4b3-0b04c79c0c37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;r1i1p1f1&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3af4802e-adfa-4a01-8ed1-728dcf39baf9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3af4802e-adfa-4a01-8ed1-728dcf39baf9' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(60, 2), meta=np.ndarray&gt;</div><input id='attrs-96cf5f9f-1459-4cd6-a9a3-18b0bd6d5120' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96cf5f9f-1459-4cd6-a9a3-18b0bd6d5120' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-544e66c9-01ed-4298-9c1a-16ef9b741013' class='xr-var-data-in' type='checkbox'><label for='data-544e66c9-01ed-4298-9c1a-16ef9b741013' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 30.94 kiB </td>
                        <td> 0.94 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (1980, 2) </td>
                        <td> (60, 2) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 67 Graph Layers </td>
                        <td> 33 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> datetime64[ns] </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="25" y2="3" />
  <line x1="0" y1="10" x2="25" y2="10" />
  <line x1="0" y1="18" x2="25" y2="18" />
  <line x1="0" y1="21" x2="25" y2="21" />
  <line x1="0" y1="29" x2="25" y2="29" />
  <line x1="0" y1="36" x2="25" y2="36" />
  <line x1="0" y1="43" x2="25" y2="43" />
  <line x1="0" y1="47" x2="25" y2="47" />
  <line x1="0" y1="54" x2="25" y2="54" />
  <line x1="0" y1="61" x2="25" y2="61" />
  <line x1="0" y1="69" x2="25" y2="69" />
  <line x1="0" y1="72" x2="25" y2="72" />
  <line x1="0" y1="80" x2="25" y2="80" />
  <line x1="0" y1="87" x2="25" y2="87" />
  <line x1="0" y1="94" x2="25" y2="94" />
  <line x1="0" y1="98" x2="25" y2="98" />
  <line x1="0" y1="105" x2="25" y2="105" />
  <line x1="0" y1="112" x2="25" y2="112" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">1980</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(lat, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(192, 2), meta=np.ndarray&gt;</div><input id='attrs-83ff6a5f-72ec-4746-99ea-34f5cbfa0bfb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-83ff6a5f-72ec-4746-99ea-34f5cbfa0bfb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0415ebc7-bd32-42bb-87d9-374b1bc3cd85' class='xr-var-data-in' type='checkbox'><label for='data-0415ebc7-bd32-42bb-87d9-374b1bc3cd85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 3.00 kiB </td>
                        <td> 3.00 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (192, 2) </td>
                        <td> (192, 2) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Graph Layers </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.60913412115106,0.0 25.60913412115106,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.804567" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.609134" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.609134,60.000000)">192</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(lon, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(384, 2), meta=np.ndarray&gt;</div><input id='attrs-3fba3fb8-73a1-4145-9696-0b04c8029acc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3fba3fb8-73a1-4145-9696-0b04c8029acc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95cb12f2-ed5d-4212-a4c9-1c5376cdeee3' class='xr-var-data-in' type='checkbox'><label for='data-95cb12f2-ed5d-4212-a4c9-1c5376cdeee3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 6.00 kiB </td>
                        <td> 6.00 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (384, 2) </td>
                        <td> (384, 2) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Graph Layers </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">384</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rlds</span></div><div class='xr-var-dims'>(member_id, time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 60, 192, 384), meta=np.ndarray&gt;</div><input id='attrs-3e988c7e-da48-4c4e-b203-dfdd0d8bc7dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3e988c7e-da48-4c4e-b203-dfdd0d8bc7dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84d7786c-283f-4d62-95a4-195a1dd92625' class='xr-var-data-in' type='checkbox'><label for='data-84d7786c-283f-4d62-95a4-195a1dd92625' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_downwelling_longwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface Downwelling Longwave Radiation</dd><dt><span>comment :</span></dt><dd>The surface called &#x27;surface&#x27; means the lower boundary of the atmosphere. &#x27;longwave&#x27; means longwave radiation. Downwelling radiation is radiation from above. It does not mean &#x27;net downward&#x27;. When thought of as being incident on a surface, a radiative flux is sometimes called &#x27;irradiance&#x27;. In addition, it is identical with the quantity measured by a cosine-collector light-meter and sometimes called &#x27;vector irradiance&#x27;. In accordance with common usage in geophysical disciplines, &#x27;flux&#x27; implies per unit area, called &#x27;flux density&#x27; in physics.</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>original_name :</span></dt><dd>rlds</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>history :</span></dt><dd>2019-08-25T06:42:06Z altered by CMOR: replaced missing value flag (-9e+33) and corresponding data with standard missing value (1e+20). 2019-08-25T06:42:06Z altered by CMOR: Inverted axis: lat.</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 556.88 MiB </td>
                        <td> 16.88 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (1, 1980, 192, 384) </td>
                        <td> (1, 60, 192, 384) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 68 Graph Layers </td>
                        <td> 33 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="352" height="159" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="95" y1="38" x2="165" y2="109" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="38" style="stroke-width:2" />
  <line x1="97" y1="2" x2="97" y2="40" />
  <line x1="99" y1="4" x2="99" y2="42" />
  <line x1="101" y1="6" x2="101" y2="44" />
  <line x1="103" y1="8" x2="103" y2="46" />
  <line x1="105" y1="10" x2="105" y2="49" />
  <line x1="107" y1="12" x2="107" y2="51" />
  <line x1="109" y1="14" x2="109" y2="53" />
  <line x1="112" y1="17" x2="112" y2="55" />
  <line x1="114" y1="19" x2="114" y2="57" />
  <line x1="116" y1="21" x2="116" y2="59" />
  <line x1="118" y1="23" x2="118" y2="61" />
  <line x1="120" y1="25" x2="120" y2="64" />
  <line x1="122" y1="27" x2="122" y2="66" />
  <line x1="124" y1="29" x2="124" y2="68" />
  <line x1="127" y1="32" x2="127" y2="70" />
  <line x1="129" y1="34" x2="129" y2="72" />
  <line x1="131" y1="36" x2="131" y2="74" />
  <line x1="133" y1="38" x2="133" y2="76" />
  <line x1="135" y1="40" x2="135" y2="79" />
  <line x1="137" y1="42" x2="137" y2="81" />
  <line x1="139" y1="44" x2="139" y2="83" />
  <line x1="142" y1="47" x2="142" y2="85" />
  <line x1="144" y1="49" x2="144" y2="87" />
  <line x1="146" y1="51" x2="146" y2="89" />
  <line x1="148" y1="53" x2="148" y2="91" />
  <line x1="150" y1="55" x2="150" y2="94" />
  <line x1="152" y1="57" x2="152" y2="96" />
  <line x1="154" y1="59" x2="154" y2="98" />
  <line x1="157" y1="62" x2="157" y2="100" />
  <line x1="159" y1="64" x2="159" y2="102" />
  <line x1="161" y1="66" x2="161" y2="104" />
  <line x1="165" y1="70" x2="165" y2="109" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 165.58823529411765,70.58823529411765 165.58823529411765,109.01386754281697 95.0,38.42563224869931" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="136" y2="0" style="stroke-width:2" />
  <line x1="97" y1="2" x2="139" y2="2" />
  <line x1="99" y1="4" x2="141" y2="4" />
  <line x1="101" y1="6" x2="143" y2="6" />
  <line x1="103" y1="8" x2="145" y2="8" />
  <line x1="105" y1="10" x2="147" y2="10" />
  <line x1="107" y1="12" x2="149" y2="12" />
  <line x1="109" y1="14" x2="151" y2="14" />
  <line x1="112" y1="17" x2="153" y2="17" />
  <line x1="114" y1="19" x2="156" y2="19" />
  <line x1="116" y1="21" x2="158" y2="21" />
  <line x1="118" y1="23" x2="160" y2="23" />
  <line x1="120" y1="25" x2="162" y2="25" />
  <line x1="122" y1="27" x2="164" y2="27" />
  <line x1="124" y1="29" x2="166" y2="29" />
  <line x1="127" y1="32" x2="168" y2="32" />
  <line x1="129" y1="34" x2="171" y2="34" />
  <line x1="131" y1="36" x2="173" y2="36" />
  <line x1="133" y1="38" x2="175" y2="38" />
  <line x1="135" y1="40" x2="177" y2="40" />
  <line x1="137" y1="42" x2="179" y2="42" />
  <line x1="139" y1="44" x2="181" y2="44" />
  <line x1="142" y1="47" x2="183" y2="47" />
  <line x1="144" y1="49" x2="186" y2="49" />
  <line x1="146" y1="51" x2="188" y2="51" />
  <line x1="148" y1="53" x2="190" y2="53" />
  <line x1="150" y1="55" x2="192" y2="55" />
  <line x1="152" y1="57" x2="194" y2="57" />
  <line x1="154" y1="59" x2="196" y2="59" />
  <line x1="157" y1="62" x2="198" y2="62" />
  <line x1="159" y1="64" x2="201" y2="64" />
  <line x1="161" y1="66" x2="203" y2="66" />
  <line x1="165" y1="70" x2="207" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="136" y1="0" x2="207" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 136.87882345035473,0.0 207.46705874447238,70.58823529411765 165.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="165" y1="70" x2="207" y2="70" style="stroke-width:2" />
  <line x1="165" y1="109" x2="207" y2="109" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="165" y1="70" x2="165" y2="109" style="stroke-width:2" />
  <line x1="207" y1="70" x2="207" y2="109" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="165.58823529411765,70.58823529411765 207.46705874447235,70.58823529411765 207.46705874447235,109.01386754281697 165.58823529411765,109.01386754281697" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="186.527647" y="129.013868" font-size="1.0rem" font-weight="100" text-anchor="middle" >384</text>
  <text x="227.467059" y="89.801051" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,227.467059,89.801051)">192</text>
  <text x="120.294118" y="93.719750" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,120.294118,93.719750)">1980</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AVHRR</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>132.0 132.0 132.1 ... 196.5 196.5</div><input id='attrs-f9f622af-3371-4b76-aed3-2253565ec922' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9f622af-3371-4b76-aed3-2253565ec922' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-390052fa-3789-4a3b-b30a-751977192342' class='xr-var-data-in' type='checkbox'><label for='data-390052fa-3789-4a3b-b30a-751977192342' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_downwelling_longwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>long_name :</span></dt><dd>Surface Downwelling Longwave Radiation</dd><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div><div class='xr-var-data'><pre>array([[132.00184631, 132.02351379, 132.07110596, ..., 132.08001709,
        132.04530334, 132.03294373],
       [132.25114441, 132.18640137, 132.17771912, ..., 132.5362854 ,
        132.41717529, 132.35961914],
       [133.7578125 , 133.70018005, 133.68547058, ..., 133.93263245,
        133.81280518, 133.83154297],
       ...,
       [199.23760986, 199.34413147, 199.45700073, ..., 198.77816772,
        198.94889832, 199.08486938],
       [198.22076416, 198.30781555, 198.39167786, ..., 197.97425842,
        198.05308533, 198.12242126],
       [196.58409119, 196.65452576, 196.72821045, ..., 196.41145325,
        196.46295166, 196.52734375]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-10e51c06-e293-459d-b784-e602401ea132' class='xr-section-summary-in' type='checkbox'  ><label for='section-10e51c06-e293-459d-b784-e602401ea132' class='xr-section-summary' >Attributes: <span>(49)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>parent_time_units :</span></dt><dd>days since 1850-1-1 00:00:00</dd><dt><span>parent_variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>title :</span></dt><dd>MPI-ESM1-2-HR output prepared for CMIP6</dd><dt><span>nominal_resolution :</span></dt><dd>100 km</dd><dt><span>branch_time_in_parent :</span></dt><dd>0.0</dd><dt><span>cmor_version :</span></dt><dd>3.5.0</dd><dt><span>parent_experiment_id :</span></dt><dd>piControl</dd><dt><span>parent_activity_id :</span></dt><dd>CMIP</dd><dt><span>mip_era :</span></dt><dd>CMIP6</dd><dt><span>data_specs_version :</span></dt><dd>01.00.30</dd><dt><span>references :</span></dt><dd>MPI-ESM: Mauritsen, T. et al. (2019), Developments in the MPI‐M Earth System Model version 1.2 (MPI‐ESM1.2) and Its Response to Increasing CO2, J. Adv. Model. Earth Syst.,11, 998-1038, doi:10.1029/2018MS001400,
Mueller, W.A. et al. (2018): A high‐resolution version of the Max Planck Institute Earth System Model MPI‐ESM1.2‐HR. J. Adv. Model. EarthSyst.,10,1383–1413, doi:10.1029/2017MS001217</dd><dt><span>history :</span></dt><dd>2019-08-25T06:42:06Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T06:40:54Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:12:27Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T06:48:37Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T06:55:58Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:24:51Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:21:12Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:27:03Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:26:53Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T07:32:44Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:34:05Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:18:40Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:21:47Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:51:53Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:36:50Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T08:40:27Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:17:04Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:09:20Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:18:23Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:20:46Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:31:01Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:41:40Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:53:56Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T09:43:52Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T10:08:00Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T10:26:16Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T10:32:20Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T10:34:59Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T10:52:39Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T11:02:42Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T11:09:33Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T11:31:15Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.
2019-08-25T11:10:33Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.</dd><dt><span>activity_id :</span></dt><dd>CMIP</dd><dt><span>table_id :</span></dt><dd>Amon</dd><dt><span>tracking_id :</span></dt><dd>hdl:21.14100/48cd3b6f-babf-44f1-a345-30963d74b36c
hdl:21.14100/b0553e79-cfe9-4c36-bf1f-f9ed2763e08a
hdl:21.14100/406bd6a9-7bab-4d3b-b241-be1bbcfe6f7c
hdl:21.14100/9ca32e11-01b1-4b36-80a2-7c6a8b335bdf
hdl:21.14100/08131958-6f30-4b5a-b872-28ef27bd10e3
hdl:21.14100/e26f14d6-9aa8-4cf4-90b4-5209f1c987ef
hdl:21.14100/a55c81b5-e6d4-4304-a006-a84b4df6ff06
hdl:21.14100/61d01e0e-ae57-478a-a62c-92bc7f67e86a
hdl:21.14100/14b9bdd2-e3cb-44ce-a6db-a1572659247b
hdl:21.14100/ab2d4ec3-c722-4dbb-9b61-e1d8c3a10d61
hdl:21.14100/2518dec3-d0ae-43b1-b9c3-2a9a57328619
hdl:21.14100/3900dbd7-7dab-46d2-bc19-7c871c38c9fd
hdl:21.14100/37357d10-5d48-4277-8d6e-b1fe06393cd1
hdl:21.14100/3cf6553a-1bd3-492f-bfab-f91b7f64fc11
hdl:21.14100/425437e1-ff46-4e08-958b-0d872fc692ed
hdl:21.14100/884605ab-b31b-417b-9bdd-d43840f29fc1
hdl:21.14100/813fa67d-e0f2-4173-b6b8-3f2770d0df47
hdl:21.14100/85d7512e-c7c0-4f20-b2dd-84a9817121d7
hdl:21.14100/726aed29-0502-4b85-b777-eb8104240e76
hdl:21.14100/9cb49ff4-0ff6-4ea7-bd48-c31b5243cfe8
hdl:21.14100/a6951a71-b384-4a1d-9ef2-96ff75d65f40
hdl:21.14100/25684450-6a0d-49d4-ac96-17cee149564c
hdl:21.14100/ed4b79d3-007a-41c4-a656-8cf10cd48f3f
hdl:21.14100/fb445234-6da8-426c-9897-12db3af9882a
hdl:21.14100/29ac1d6c-85dd-4d0c-9047-3d296169478f
hdl:21.14100/41049434-86fb-43ca-9551-2a3956b3d530
hdl:21.14100/881f515e-cfa7-4334-a216-529fb0ce9b0a
hdl:21.14100/f5b5d38e-25b9-49e2-9b76-8c0cb570fb18
hdl:21.14100/f5907d19-0740-49d6-a2d9-554c7f110a83
hdl:21.14100/e4723af8-597e-4b4e-be27-3fd0c0afe958
hdl:21.14100/0cabe24b-113a-4ae4-a652-b853cb3ef4b2
hdl:21.14100/79861c75-8fca-4d20-84de-f9439b729d3d
hdl:21.14100/3904cca8-2d8c-4422-b939-2f390e665310</dd><dt><span>source_id :</span></dt><dd>MPI-ESM1-2-HR</dd><dt><span>parent_mip_era :</span></dt><dd>CMIP6</dd><dt><span>realization_index :</span></dt><dd>1</dd><dt><span>variable_id :</span></dt><dd>rlds</dd><dt><span>branch_time_in_child :</span></dt><dd>0.0</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>intake_esm_varname :</span></dt><dd>[&#x27;rlds&#x27;]</dd><dt><span>forcing_index :</span></dt><dd>1</dd><dt><span>project_id :</span></dt><dd>CMIP6</dd><dt><span>parent_source_id :</span></dt><dd>MPI-ESM1-2-HR</dd><dt><span>source_type :</span></dt><dd>AOGCM</dd><dt><span>sub_experiment :</span></dt><dd>none</dd><dt><span>sub_experiment_id :</span></dt><dd>none</dd><dt><span>source :</span></dt><dd>MPI-ESM1.2-HR (2017): 
aerosol: none, prescribed MACv2-SP
atmos: ECHAM6.3 (spectral T127; 384 x 192 longitude/latitude; 95 levels; top level 0.01 hPa)
atmosChem: none
land: JSBACH3.20
landIce: none/prescribed
ocean: MPIOM1.63 (tripolar TP04, approximately 0.4deg; 802 x 404 longitude/latitude; 40 levels; top grid cell 0-12 m)
ocnBgchem: HAMOCC6
seaIce: unnamed (thermodynamic (Semtner zero-layer) dynamic (Hibler 79) sea ice model)</dd><dt><span>Conventions :</span></dt><dd>CF-1.7 CMIP-6.2</dd><dt><span>creation_date :</span></dt><dd>2019-08-25T11:10:33Z</dd><dt><span>table_info :</span></dt><dd>Creation Date:(09 May 2019) MD5:e6ef8ececc8f338646ebfb3aeed36bfc</dd><dt><span>experiment_id :</span></dt><dd>historical</dd><dt><span>institution :</span></dt><dd>Max Planck Institute for Meteorology, Hamburg 20146, Germany</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>branch_method :</span></dt><dd>standard</dd><dt><span>physics_index :</span></dt><dd>1</dd><dt><span>external_variables :</span></dt><dd>areacella</dd><dt><span>experiment :</span></dt><dd>all-forcing simulation of the recent past</dd><dt><span>grid_label :</span></dt><dd>gn</dd><dt><span>variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>contact :</span></dt><dd>cmip6-mpi-esm@dkrz.de</dd><dt><span>grid :</span></dt><dd>gn</dd><dt><span>initialization_index :</span></dt><dd>1</dd><dt><span>product :</span></dt><dd>model-output</dd><dt><span>license :</span></dt><dd>CMIP6 model data produced by MPI-M is licensed under a Creative Commons Attribution ShareAlike 4.0 International License (https://creativecommons.org/licenses). Consult https://pcmdi.llnl.gov/CMIP6/TermsOfUse for terms of use governing CMIP6 output, including citation requirements and proper acknowledgment. Further information about this data, including some limitations, can be found via the further_info_url (recorded as a global attribute in this file) and. The data producers and data providers make no warranty, either express or implied, including, but not limited to, warranties of merchantability and fitness for a particular purpose. All liabilities arising from the supply of the information (including any liability arising in negligence) are excluded to the fullest extent permitted by law.</dd><dt><span>further_info_url :</span></dt><dd>https://furtherinfo.es-doc.org/CMIP6.MPI-M.MPI-ESM1-2-HR.historical.none.r1i1p1f1</dd><dt><span>institution_id :</span></dt><dd>MPI-M</dd><dt><span>intake_esm_dataset_key :</span></dt><dd>CMIP.MPI-ESM1-2-HR.historical.Amon.gn</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="validate-the-model">
<h2>4. Validate the model<a class="headerlink" href="#validate-the-model" title="Permalink to this headline">#</a></h2>
<p>Finally, we can create a difference map between our datasets and calculate its corresponding bias and RMSE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the differene map</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="s1">&#39;AVHRR&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dset</span><span class="p">[</span><span class="s1">&#39;rlds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;2014-12-16T12:00:00&#39;</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[:,:,</span><span class="s1">&#39;member_id&#39;</span> <span class="o">==</span> <span class="s1">&#39;r1i1p1f1&#39;</span><span class="p">]</span>

<span class="c1">#Calculate the bias and the RMSE </span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Plot the results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>

<span class="c1"># Print the bias and the RMSE in a textbox</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
    <span class="sa">r</span><span class="s1">&#39;bias = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bias</span><span class="p">,</span> <span class="p">),</span>
    <span class="sa">r</span><span class="s1">&#39;RMSE = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="p">)))</span>

<span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span> <span class="o">=</span> <span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
        <span class="n">verticalalignment</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span> <span class="n">props</span><span class="p">)</span>

<span class="c1"># Add a color bar and a title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Difference map between CMIP6 and AVHRR-derived Surface Downwelling Longwave Radiation, W m-2&#39;</span><span class="p">,</span> 
          <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="s1">&#39;fontweight&#39;</span> <span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/validation-with-obs_19_0.png" src="_images/validation-with-obs_19_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cehbrecht/jupyter-guide-to-climate-data",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "summerschool_2022"
        },
        kernelOptions: {
            kernelName: "summerschool_2022",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'summerschool_2022'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="gis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Prepare modeling data for GIS analyses</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By DKRZ<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>